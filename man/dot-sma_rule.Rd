% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api-functions.R
\name{.sma_rule}
\alias{.sma_rule}
\title{Create or Retrieve an SMA Rule}
\usage{
.sma_rule(
  sma_name,
  rule_name,
  scope,
  definition = NULL,
  bbfields = NULL,
  max_threshold = Inf,
  min_threshold = -Inf,
  swap_only = FALSE,
  gross_exposure = FALSE,
  relative_to = "nav",
  divisor = NULL,
  side = NULL,
  exclusions = NULL
)
}
\arguments{
\item{sma_name}{A string representing the name of the SMA.
Must be a valid SMA name.}

\item{rule_name}{A string representing the name of the rule.}

\item{scope}{One of "position", "portfolio", or "count" indicating the scope
of the rule.}

\item{definition}{A function defining the rule's logic.
Must be a valid function object. May be `NULL` if `scope` is "count".}

\item{bbfields}{A character vector of Bloomberg fields to be used in the
rule's logic.}

\item{max_threshold}{(Optional) A numeric value specifying the maximum
threshold for the rule. If not provided, defaults to `Inf`.}

\item{min_threshold}{(Optional) A numeric value specifying the minimum
threshold for the rule. If not provided, defaults to `-Inf`.}

\item{swap_only}{A logical value indicating whether the rule applies only to
swaps. Defaults to `FALSE`.}

\item{side}{(Optional) A string indicating the side of the rule.
Valid values are "long", "short", or "gross". Used for position count rules.}

\item{exclusions}{(Optional) A character vector of security IDs to be
excluded from the rule.}
}
\value{
An object of class `SMARule` representing the SMA rule.
}
\description{
This function creates or retrieves an SMA rule object associated with a
 specific SMA. The rule defines certain conditions or thresholds for the SMA
 and can be scoped to positions, portfolios, or count.
}
\details{
The function first checks if the rule already exists in the `smarules`
 registry. If it exists, the existing rule is returned. Otherwise, a new
 rule is created and stored in the registry. The rule's scope determines
 whether it applies to individual positions, the entire portfolio, or count.
}
\examples{
# Example usage:
my_rule <- .sma_rule(
  sma_name = "example_sma",
  rule_name = "example_rule",
  scope = "position",
  definition = function(x) x > 0,
  max_threshold = 100,
  min_threshold = 10
)

}
\seealso{
[SMARule()]
}
